# Azure Policy Rules

This document provides a comprehensive index of Azure policies available in BrainIAC.

| ID         | Type     | Entity                                                | Policy                                                                           | Resource                                                                                                    |
| ---------- | -------- | ----------------------------------------------------- | -------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------- |
| CB_AZR_001 | resource | Microsoft.Compute/virtualMachines                     | Verify Azure Instance does not use basic authentication (Use SSH Key Instead)    | checker/azurearm/rules/azr_not_allow_basic_auth.rego                                                        |
| CB_AZR_002 | resource | Microsoft.Compute/disks                               | Verify encryption for Azure manage disk is enabled                               | checker/azurearm/rules/encryption/verify_disk_encryption_enabled.rego                                       |
| CB_AZR_003 | resource | Microsoft.Storage/storageAccounts                     | Verify HTTPS only allowed if supportsHttpsTrafficOnly is true                    | checker/azurearm/rules/encryption/verify_support_https_traffic_only_true.rego                               |
| CB_AZR_004 | resource | Microsoft.ContainerService/managedClusters            | Verify Azure monitoring for AKS logging is configured                            | checker/azurearm/rules/kubernetes/verify_azure_monitoring_configured.rego                                   |
| CB_AZR_005 | resource | Microsoft.ContainerService/managedClusters            | Verify RBAC on AKS clusters are enabled                                          | checker/azurearm/rules/kubernetes/verify_rabc_is_enabled.rego                                               |
| CB_AZR_006 | resource | Microsoft.ContainerService/managedClusters            | Verify API server authorized IP ranges for AKS are enabled                       | checker/azurearm/rules/kubernetes/verify_api_authorized_ip_ranges_enabled.rego                              |
| CB_AZR_007 | resource | Microsoft.ContainerService/managedClusters            | Verify Network Policy for AKS are configured                                     | checker/azurearm/rules/kubernetes/verify_aks_network_policy_configured.rego                                 |
| CB_AZR_008 | resource | Microsoft.ContainerService/managedClusters            | Verify Kubernetes Dashboard are disabled                                         | checker/azurearm/rules/kubernetes/verify_kubernetes_dashboard_disabled.rego                                 |
| CB_AZR_009 | resource | Microsoft.Network/networkSecurityGroups               | Verify access for RDP is restricted from the internet                            | checker/azurearm/rules/networking/verify_rdp_access_restricted.rego                                         |
| CB_AZR_009 | resource | Microsoft.Network/networkSecurityGroups/securityRules | Verify access for RDP is restricted from the internet                            | checker/azurearm/rules/networking/verify_rdp_access_restricted.rego                                         |
| CB_AZR_010 | resource | Microsoft.Network/networkSecurityGroups               | Verify access for SSH is restricted from the internet                            | checker/azurearm/rules/networking/verify_ssh_access_restricted.rego                                         |
| CB_AZR_010 | resource | Microsoft.Network/networkSecurityGroups/securityRules | Verify access for SSH is restricted from the internet                            | checker/azurearm/rules/networking/verify_ssh_access_restricted.rego                                         |
| CB_AZR_011 | resource | Microsoft.Sql/servers                                 | Verify Azure SQL databases do not allow ingress from 0.0.0.0/0                   | checker/azurearm/rules/logging/azr_sql_database_not_allow_ingress.rego                                      |
| CB_AZR_012 | resource | Microsoft.Network/networkWatchers/FlowLogs            | Verify Network Security Group Flow Log retention period is greater than 90 days  | checker/azurearm/rules/logging/azr_network_security_group_retention_period.rego                             |
| CB_AZR_012 | resource | Microsoft.Network/networkWatchers/FlowLogs            | Verify Network Security Group Flow Log retention period is greater than 90 days  | checker/azurearm/rules/logging/azr_network_security_group_retention_period.rego                             |
| CB_AZR_012 | resource | Microsoft.Network/networkWatchers/flowLogs            | Verify Network Security Group Flow Log retention period is greater than 90 days  | checker/azurearm/rules/logging/azr_network_security_group_retention_period.rego                             |
| CB_AZR_012 | resource | Microsoft.Network/networkWatchers/flowLogs            | Verify Network Security Group Flow Log retention period is greater than 90 days  | checker/azurearm/rules/logging/azr_network_security_group_retention_period.rego                             |
| CB_AZR_013 | resource | Microsoft.Web/sites/config                            | Verify Azure App Service has App Service Authentication configured               | checker/azurearm/rules/IAM/azr_app_service_auth_set_app_service.rego                                        |
| CB_AZR_013 | resource | config                                                | Verify Azure App Service has App Service Authentication configured               | checker/azurearm/rules/IAM/azr_app_service_auth_set_app_service.rego                                        |
| CB_AZR_014 | resource | Microsoft.Web/sites                                   | Verify Web App redirects all HTTP traffic to HTTPS in Azure App Service          | checker/azurearm/rules/networking/azr_web_app_redirect_http_traffic_to_https.rego                           |
| CB_AZR_015 | resource | Microsoft.Web/sites                                   | Verify Web App utilizes the most recent version of TLS encryption                | checker/azurearm/rules/networking/azr_web_app_latest_tls_encryption.rego                                    |
| CB_AZR_016 | resource | Microsoft.Web/sites                                   | Verify App Service has Register with Azure Active Directory feature enabled      | checker/azurearm/rules/IAM/azr_register_active_directory_enabled.rego                                       |
| CB_AZR_017 | resource | Microsoft.Web/sites                                   | Verify Web App has Incoming client certificates configured                       | checker/azurearm/rules/networking/azr_web_app_client_certificates_enabled.rego                              |
| CB_AZR_018 | resource | Microsoft.Web/sites                                   | Verify Web App utilizes the latest version of the HTTP protocol                  | checker/azurearm/rules/networking/azr_web_app_http_version_latest.rego                                      |
| CB_AZR_019 | resource | Microsoft.Security/pricings                           | Verify that standard pricing tier is selected                                    | checker/azurearm/rules/networking/azr_standard_pricing_tier_selected.rego                                   |
| CB_AZR_020 | resource | Microsoft.Security/securityContacts                   | Verify security contact's 'Phone number' is configured                           | checker/azurearm/rules/networking/azr_security_contact_phone_number_set.rego                                |
| CB_AZR_021 | resource | Microsoft.Security/securityContacts                   | Verify send email notifications is enabled for high severity alerts              | checker/azurearm/rules/networking/verify_high_severity_alerts_for_send_email_notfication_is_on.rego         |
| CB_AZR_022 | resource | Microsoft.Security/securityContacts                   | Verify email notifications is enabled for high severity alerts to administrators | checker/azurearm/rules/networking/verify_that_email_notifications_are_enabled_for_high_severity_alerts.rego |
| CB_AZR_023 | resource | Microsoft.Sql/servers                                 | Verify that 'Auditing' is enabled for SQL servers                                | checker/azurearm/rules/logging/verify_that_auditing_is_enabled_for_sql_servers.rego                         |
| CB_AZR_023 | resource | Microsoft.Sql/servers/databases                       | Verify that 'Auditing' is enabled for SQL servers                                | checker/azurearm/rules/logging/verify_that_auditing_is_enabled_for_sql_servers.rego                         |
| CB_AZR_024 | resource | Microsoft.Sql/servers                                 | Verify that the Auditing Retention for SQL servers exceeds 90 days               | checker/azurearm/rules/logging/verify_that_auditing_retention_for_sql_servers_exceeds_90_days.rego          |
| CB_AZR_025 | resource | Microsoft.Sql/servers/databases                       | Verify Threat Detection types setting is configured to All                       | checker/azurearm/rules/general_security/verify_threat_detection_types_setting_is_configured_to_all.rego     |
| CB_AZR_026 | resource | Microsoft.Sql/servers/databases                       | Verify 'Send Alerts To' feature is activated for MSSQL servers                   | checker/azurearm/rules/general_security/verify_send_alerts_to_enabled_for_mssql_servers.rego                |
| CB_AZR_027 | resource | Microsoft.Sql/servers/databases                       | Verify 'Email service and co-administrators' is activated for MSSQL servers      | checker/azurearm/rules/general_security/verify_that_the_email_service_and_co_administrators_are_enabled_for_mssql_servers.rego     |
| CB_AZR_028 | resource | Microsoft.DBforMySQL/servers                          | Verify 'Enforce SSL connection' setting is enabled for MySQL Database Server     | checker/azurearm/rules/networking/verify_mysql_database_server_has_enforce_ssl_connection_enabled.rego      |
| CB_AZR_029 | resource | Microsoft.DBforPostgreSQL/servers                     | Verify 'Enforce SSL connection' setting is enabled for PostgresSQL Database Server   | checker/azurearm/rules/networking/verify_enforce_ssl_connection_set_enabled_for_postgresql_database_server.rego                     |
| CB_AZR_030 | resource | Microsoft.DBforPostgreSQL/servers/configurations      | Verify log_checkpoints Parameter is ON for PostgreSQL Server                     | checker/azurearm/rules/networking/verify_log_checkpoints_parameter_is_on_for_postgresql_server.rego         |
| CB_AZR_030 | resource | configurations                                        | Verify log_checkpoints Parameter is ON for PostgreSQL Server                     | checker/azurearm/rules/networking/verify_log_checkpoints_parameter_is_on_for_postgresql_server.rego         |
| CB_AZR_031 | resource | Microsoft.DBforPostgreSQL/servers/configurations      | Verify PostgreSQL Database Server configuration for 'log_connections' is enabled | checker/azurearm/rules/networking/azr_configuration_log_connnection_on_postgresql.rego                      |
| CB_AZR_031 | resource | configurations                                        | Verify PostgreSQL Database Server configuration for 'log_connections' is enabled | checker/azurearm/rules/networking/azr_configuration_log_connnection_on_postgresql.rego                      |
| CB_AZR_032 | resource | Microsoft.DBforPostgreSQL/servers/configurations | Verify server parameter 'connection_throttling' is enabled for PostgreSQL Database Server | checker/azurearm/rules/networking/azr_configuration_connection_throttling_on_postgresql.rego                |
| CB_AZR_032 | resource | configurations                                   | Verify server parameter 'connection_throttling' is enabled for PostgreSQL Database Server | checker/azurearm/rules/networking/azr_configuration_connection_throttling_on_postgresql.rego                |
| CB_AZR_033 | resource | Microsoft.Storage/storageAccounts/queueServices/providers/diagnosticsettings | Verify Storage logging is enabled for Queue service for read, write and delete requests         | checker/azurearm/rules/logging/azr_storage_logging_queue_service_read_write_delete_enabled.rego  |
| CB_AZR_034 | resource | Microsoft.Storage/storageAccounts/blobServices/containers | Verify 'Public access level' is configured as Private for blob containers.   | checker/azurearm/rules/networking/azr_public_access_level_set_to_private_blob.rego                          |
| CB_AZR_034 | resource | blobServices/containers                               | Verify 'Public access level' is configured as Private for blob containers.       | checker/azurearm/rules/networking/azr_public_access_level_set_to_private_blob.rego                          |
| CB_AZR_034 | resource | containers                                            | Verify 'Public access level' is configured as Private for blob containers.       | checker/azurearm/rules/networking/azr_public_access_level_set_to_private_blob.rego                          |
| CB_AZR_035 | resource | Microsoft.Storage/storageAccounts                     | Verify Storage Accounts default network access rule is configured to deny        | checker/azurearm/rules/networking/azr_default_network_access_deny_storage_account.rego                      |
| CB_AZR_036 | resource | Microsoft.Storage/storageAccounts                     | Verify access to Storage Accounts is enabled for 'Trusted Microsoft Services'    | checker/azurearm/rules/networking/azr_trusted_microsoft_services_storage_account_access.rego                |
| CB_AZR_037 | resource | Microsoft.Insights/logprofiles                        | Verify Activity Log Retention is configured for 365 days or longer               | checker/azurearm/rules/logging/azr_activity_log_retention_days_set_to_365_days_or_greater.rego              |
| CB_AZR_038 | resource | Microsoft.Insights/logprofiles                        | Verify audit profile is set to capture all activities                            | checker/azurearm/rules/logging/azr_audit_profile_captures_all_activities.rego                               |
| CB_AZR_039 | resource | Microsoft.Authorization/roleDefinitions               | Verify that there are no custom subscription owner roles created                 | checker/azurearm/rules/IAM/azr_no_custom_subscription_owner_roles_created.rego                              |
| CB_AZR_040 | resource | Microsoft.KeyVault/vaults/keys                        | Verify all keys have an expiration date set                                      | checker/azurearm/rules/general_security/azr_expiration_date_set_on_all_keys.rego                            |
| CB_AZR_041 | resource | Microsoft.KeyVault/vaults/secrets                     | Verify expiration date is set for all secrets                                    | checker/azurearm/rules/general_security/verify_expiration_set_all_secrets.rego                              |
| CB_AZR_042 | resource | Microsoft.KeyVault/vaults                             | Verify key vault is recoverable                                                  | checker/azurearm/rules/backup_and_recovery/verify_key_vault_recoverable.rego                                |
| CB_AZR_043 | resource | Microsoft.DBforMariaDB/servers                        | Verify SSL connection is enabled for MariaDB servers                             | checker/azurearm/rules/networking/azr_ssl_connection_enabled.rego                                           |
| CB_AZR_044 | resource | Microsoft.Compute/virtualMachineScaleSets             | Verify Azure Linux scale set doesn't use basic authentication                    | checker/azurearm/rules/general_security/azr_linux_not_use_basic_authentication.rego                         |
| CB_AZR_045 | resource | Microsoft.Compute/virtualMachines                     | Verify extensions for Virtual Machine are not installed                          | checker/azurearm/rules/general_security/azr_virtual_machine_extensions_not_installed.rego                   |
| CB_AZR_046 | resource | Microsoft.Synapse/workspaces                          | Verify manage virtual networks for Azure Synapse workspaces are enabled          | checker/azurearm/rules/networking/azr_synapse_enables_virtual_network.rego                                  |
| CB_AZR_047 | resource | Microsoft.Storage/storageAccounts                     | Verify public access for Storage accounts is not allowed                         | checker/azurearm/rules/networking/azr_account_disallow_public_access.rego                                   |
| CB_AZR_048 | resource | Microsoft.Web/sites/config                            | Verify HTTP logging for App Service is enabled                                   | checker/azurearm/rules/logging/azr_appservice_http_logging_enabled.rego                                     |
| CB_AZR_049 | resource | Microsoft.Web/sites/config                            | Verify detailed error messages for App Service is enabled                        | checker/azurearm/rules/logging/azr_appservice_error_message_enabled.rego                                    |
| CB_AZR_050 | resource | Microsoft.Web/sites/config                            | Verify failed request tracing for App Service is enabled                         | checker/azurearm/rules/logging/azr_appservice_failed_request_tracing_enabled.rego                           |
| CB_AZR_051 | resource | Microsoft.Web/sites/config                            | Verify Utilization of Latest Net Framework in Web Application                    | checker/azurearm/rules/general_security/verify_utilization_of_latest_net_framework_in_web_application.rego  |
| CB_AZR_052 | resource | Microsoft.Web/sites/config                            | Verify app services are configured to use Azure Files                            | checker/azurearm/rules/logging/verify_app_services_utilize_azure_files.rego                                 |
| CB_AZR_053 | resource | Microsoft.Cache/redis                                 | Verify Redis public network access is disabled for Azure Cache                   | checker/azurearm/rules/networking/verify_azure_cache_for_redis_disables_public_network_access.rego          |
| CB_AZR_054 | resource | Microsoft.Compute/disks                               | Verify managed disks utilize specified encryption for customer-managed keys      | checker/azurearm/rules/encryption/verify_managed_disks_utilize_specified_encryption_for_customer_managed_keys.rego                  |
| CB_AZR_055 | resource | Microsoft.DBforMySQL/flexibleServers                  | Verify geo-redundant backups is enabled for My SQL server                        | checker/azurearm/rules/backup_and_recovery/verify_the_configuration_for_geo_redundant_backups_in_my_sql_server.rego                 |
| CB_AZR_056 | resource | Microsoft.Compute/virtualMachineScaleSets             | Verify Automatic OS Patching for VM Scale Sets                                   | checker/azurearm/rules/general_security/verify_automatic_os_patching_for_vm_scale_sets.rego                 |
| CB_AZR_057 | resource | Microsoft.DBforMySQL/flexibleServers                  | Verify infrastructure encryption are enabled for MySQL Server                    | checker/azurearm/rules/encryption/verify_mysql_server_infrastructure_encryption_activation.rego             |
| CB_AZR_058 | resource | Microsoft.Compute/virtualMachineScaleSets             | Verify VM Scale Sets have encryption-at-host enabled                             | checker/azurearm/rules/encryption/verify_vm_scale_sets_have_encryption_at_host_enabled.rego                 |
| CB_AZR_058 | resource | Microsoft.Compute/virtualMachines                     | Verify VM Scale Sets have encryption-at-host enabled                             | checker/azurearm/rules/encryption/verify_vm_scale_sets_have_encryption_at_host_enabled.rego                 |
| CB_AZR_059 | resource | Microsoft.DocumentDB/databaseAccounts                 | Verify Cosmos DB uses customer-managed keys for data encryption                  | checker/azurearm/rules/networking/verify_cosmos_db_uses_customer_managed_keys_for_data_encryption.rego      |
| CB_AZR_060 | resource | Microsoft.DocumentDB/databaseAccounts                 | Verify public network access is disabled for Azure Cosmos DB                     | checker/azurearm/rules/networking/verify_azure_cosmos_db_disables_public_network_access.rego                |
| CB_AZR_061 | resource | Microsoft.DataFactory/factories                       | Verify Azure Data Factory utilizes Git repository for source control             | checker/azurearm/rules/general_security/azr_data_factory_uses_git_repository.rego                           |
| CB_AZR_062 | resource | Microsoft.ApiManagement/service                       | Verify API management services utilizes virtual networks                         | checker/azurearm/rules/networking/azr_api_services_use_virtual_networks.rego                                |
| CB_AZR_063 | resource | Microsoft.KeyVault/vaults                             | Verify Firewall rules settings on Key vault are allowed                          | checker/azurearm/rules/networking/azr_key_vault_allow_firewall_settings.rego                                |
| CB_AZR_064 | resource | Microsoft.KeyVault/vaults                             | Verify that key vault has soft delete enabled                                    | checker/azurearm/rules/logging/azr_key_vault_enables_soft_delete.rego                                       |
| CB_AZR_065 | resource | Microsoft.KeyVault/vaults/keys                        | Verify key vault is supported by HSM                                             | checker/azurearm/rules/backup_and_recovery/azr_key_vault_backed_hsm.rego                                    |
| CB_AZR_066 | resource | Microsoft.Sql/servers                                 | Verify SQL server has disabled public network access                             | checker/azurearm/rules/networking/azr_sql_server_disable_public_network.rego                                |
| CB_AZR_067 | resource | Microsoft.KeyVault/vaults/secrets                     | Verify content type is configured for Key Vault secrets                          | checker/azurearm/rules/general_security/azr_key_vault_have_content_type.rego                                |
| CB_AZR_068 | resource | Microsoft.Network/frontDoors                          | Verify WAF is enabled on Azure Front Door                                        | checker/azurearm/rules/networking/azr_frontdoor_waf_enabled.rego                                            |
| CB_AZR_069 | resource | Microsoft.Network/FrontDoorWebApplicationFirewallPolicies | Verify Azure Front Door utilizes WAF in various modes                        | checker/azurearm/rules/networking/azr_uses_waf_different_modes.rego                                         |
| CB_AZR_070 | resource | Microsoft.DBforPostgreSQL/servers                     | Verify infrastructure encryption for PostgresSQL server is enabled               | checker/azurearm/rules/encryption/azr_postgres_server_enable_encryption.rego                                |
| CB_AZR_071 | resource | secureString                                          | Verify that SecureString parameter should not have hardcoded default values      | checker/azurearm/rules/secrets/azr_secure_string_parameter_no_hardcoded_default_values.rego                 |
| CB_AZR_072 | resource | Microsoft.DocumentDB/databaseAccounts  | Verify CosmosDB does not allow privileged escalation by restricting management plane changes    | checker/azurearm/rules/general_security/azr_cosmos_db_privileged_escalation_restriction.rego                |
| CB_AZR_073 | resource | Microsoft.CognitiveServices/accounts                  | Verify that Cognitive Services accounts have public network access disabled      | checker/azurearm/rules/networking/azr_cognitive_services_public_network_access.rego                         |
| CB_AZR_074 | resource | Microsoft.Compute/virtualMachineScaleSets             | Verify that password authentication is not enabled on Virtual Machine            | checker/azurearm/rules/encryption/azr_virtual_machine_enable_password_authentication.rego                   |
| CB_AZR_074 | resource | Microsoft.Compute/virtualMachines                     | Verify that password authentication is not enabled on Virtual Machine            | checker/azurearm/rules/encryption/azr_virtual_machine_enable_password_authentication.rego                   |
| CB_AZR_075 | resource | Microsoft.Compute/virtualMachines                     | Verify Windows VM enables encryption                                             | checker/azurearm/rules/encryption/azr_windows_virtual_machine_enables_encryption.rego                       |
| CB_AZR_076 | resource | Microsoft.Network/networkSecurityGroups               | Verify Internet Access Restricted in HTTP port 80                                | checker/azurearm/rules/networking/verify_internet_access_restricted_in_http_port_80.rego                    |
| CB_AZR_076 | resource | Microsoft.Network/networkSecurityGroups/securityRules | Verify Internet Access Restricted in HTTP port 80                                | checker/azurearm/rules/networking/verify_internet_access_restricted_in_http_port_80.rego                    |
| CB_AZR_077 | resource | Microsoft.Network/azureFirewalls                      | Verify Azure Firewalls DenyIntelMode set to Deny                                 | checker/azurearm/rules/networking/verify_azure_firewalls_denyintelmode_deny.rego                            |
| CB_AZR_078 | resource | Microsoft.Storage/storageAccounts                     | Verify latest version TLS encryption used in Storage Account                     | checker/azurearm/rules/networking/verify_latest_version_tls_encryption_storage_account.rego                 |



